# 要件定義書: JavaScriptクイズゲーム

**文書バージョン:** 1.0  
**作成日:** 2025年11月11日  
**作成者:** rintarou  
**ステータス:** 初稿  

---

## 1. 背景と目的

### 1.1 背景
JavaScriptとJSONをデータベースとして組み込んだプログラムの学習および実践を目的とする。JSONファイルをデータストアとして扱い、シンプルなブラウザベースのアプリケーションを構築する。

### 1.2 目的
- JavaScriptによるJSON操作の実践的な学習
- ブラウザで動作するシンプルなクイズゲームの実装
- 外部データベース不要で完結する軽量アプリケーションの開発

### 1.3 対象ユーザー
- 自分用(開発者本人)

### 1.4 成果物の位置づけ
- 個人の学習用プロトタイプ
- 過度に複雑にせず、理解しやすく保守しやすいコードで実装

---

## 2. プロジェクト概要

### 2.1 プロジェクト名
JavaScriptクイズゲーム

### 2.2 システム概要
ブラウザ上で動作する4択クイズゲーム。問題データはJSONファイルで管理し、JavaScriptで読み込んで表示する。ユーザーは10問のクイズにランダム順で回答し、最後に正解数を確認できる。

### 2.3 プロジェクトスコープ

#### 対象範囲(IN)
- ブラウザで動作するクイズゲームUI
- JSONファイルからの問題データ読み込み
- 4択形式の問題表示と回答機能
- ランダム出題機能
- スコア集計と結果表示
- 問題データのJSON形式定義

#### 対象外範囲(OUT)
- サーバーサイド処理
- データベース(MySQL、MongoDB等)の利用
- ユーザー認証・ログイン機能
- スコアの永続化(保存)
- ランキング機能
- タイマー機能
- ヒント機能
- 問題の追加・編集UI(JSONファイルを直接編集)
- カテゴリ分類機能
- 難易度レベル機能
- マルチプレイヤー対応

---

## 3. 用語定義

| 用語 | 定義 |
|------|------|
| クイズ問題 | 質問文、4つの選択肢、正解番号を含むデータ |
| JSON | JavaScript Object Notation。問題データを格納するファイル形式 |
| ランダム出題 | 問題をシャッフルして順不同で表示する機能 |
| スコア | 正解数を集計した結果 |
| MVP | Minimum Viable Product。最小限の動作可能な製品 |

---

## 4. 機能要件

### 4.1 機能一覧

| 機能ID | 機能名 | 優先度 | 概要 |
|--------|--------|--------|------|
| F001 | 問題読み込み | 必須 | JSONファイルから問題データを読み込む |
| F002 | ランダム出題 | 必須 | 読み込んだ問題をランダムな順序で出題 |
| F003 | 問題表示 | 必須 | 質問文と4つの選択肢を画面に表示 |
| F004 | 回答受付 | 必須 | ユーザーの選択を受け付ける |
| F005 | 正誤判定 | 必須 | 選択した回答が正解か判定する |
| F006 | 次問題遷移 | 必須 | 回答後、次の問題に進む |
| F007 | スコア集計 | 必須 | 全問終了後、正解数を集計 |
| F008 | 結果表示 | 必須 | 最終スコアを表示(例: 10問中8問正解) |
| F009 | 再挑戦 | 推奨 | 結果画面から再度クイズを開始できる |

### 4.2 機能詳細

#### F001: 問題読み込み
- **入力:** `quizzes.json` ファイル
- **処理:** 
  - ブラウザのFetch APIまたは静的読み込みでJSONを取得
  - パースして配列として保持
- **出力:** 問題データ配列
- **例外処理:** JSONファイルが存在しない、または形式が不正な場合はエラーメッセージ表示

#### F002: ランダム出題
- **入力:** 問題データ配列
- **処理:** Fisher-Yatesシャッフルアルゴリズム等でランダムソート
- **出力:** シャッフルされた問題配列

#### F003: 問題表示
- **入力:** 現在の問題オブジェクト
- **処理:** 
  - 問題番号(例: 1/10)
  - 質問文
  - 4つの選択肢(A, B, C, D)を表示
- **出力:** HTML要素として画面に描画

#### F004: 回答受付
- **入力:** ユーザーのクリックイベント(選択肢A〜D)
- **処理:** 選択された選択肢のインデックスを記録
- **出力:** 選択状態の視覚的フィードバック(ボタンのハイライト等)

#### F005: 正誤判定
- **入力:** ユーザーの選択インデックス、正解インデックス
- **処理:** 一致判定
- **出力:** 
  - 正解の場合: スコアカウンタ+1
  - 不正解の場合: スコアそのまま
- **表示:** 正解/不正解のフィードバック表示(任意)

#### F006: 次問題遷移
- **入力:** 現在の問題インデックス
- **処理:** 
  - インデックス+1
  - 次の問題が存在する場合はF003に戻る
  - 全問終了の場合はF008に進む
- **出力:** 次の問題または結果画面

#### F007: スコア集計
- **入力:** 各問題の正誤結果
- **処理:** 正解数をカウント
- **出力:** 正解数(例: 8)

#### F008: 結果表示
- **入力:** 総問題数、正解数
- **処理:** 結果メッセージの生成
- **出力:** 
  - 「10問中8問正解!」のようなメッセージ
  - 正解率(例: 80%)の表示(任意)

#### F009: 再挑戦
- **入力:** ユーザーのボタンクリック
- **処理:** 
  - スコアリセット
  - 問題を再シャッフル
  - 最初の問題に戻る
- **出力:** 初期画面

---

## 5. 非機能要件

### 5.1 性能要件

| 項目 | 要件 | 目標値 |
|------|------|--------|
| 問題データ読み込み時間 | ページ読み込みから表示まで | 1秒以内 |
| 回答レスポンス | ボタンクリック後の反応 | 即座(100ms以内) |
| 対応問題数 | 初期実装 | 10問 |
| 対応問題数 | 将来拡張 | 100問程度まで対応可能な設計 |

### 5.2 使いやすさ要件
- シンプルで直感的なUI
- ボタンクリック操作のみで完結
- 回答状況の視覚的フィードバック(選択中の選択肢を明示)

### 5.3 保守性要件
- コードは読みやすく、コメント付き
- 関数は単一責任で分割
- 変数名は意味が明確
- 将来的に機能追加しやすい構造

### 5.4 互換性要件
- 対応ブラウザ: 
  - Google Chrome(最新版)
  - Microsoft Edge(最新版)
  - Firefox(最新版)
- ES6以降のJavaScript文法を使用可能

### 5.5 セキュリティ要件
- ローカル実行のため、外部通信なし
- 機密情報の取り扱いなし
- XSS対策として、ユーザー入力がある場合は適切にエスケープ(現時点では選択のみのため低リスク)

### 5.6 信頼性要件
- JSONデータが不正な場合、エラーメッセージを表示してアプリが停止しない
- 最低限のバリデーション:
  - 問題データが配列か
  - 各問題に必須フィールド(question, options, correctAnswer)が存在するか

---

## 6. データ定義

### 6.1 問題データ(JSON)

**ファイル名:** `quizzes.json`

**構造:**
```json
{
  "quizzes": [
    {
      "id": 1,
      "question": "JavaScriptで変数を宣言するキーワードは次のうちどれ?",
      "options": [
        "let",
        "def",
        "var",
        "int"
      ],
      "correctAnswer": 0
    },
    {
      "id": 2,
      "question": "日本の首都はどこ?",
      "options": [
        "大阪",
        "東京",
        "京都",
        "名古屋"
      ],
      "correctAnswer": 1
    }
  ]
}
```

**フィールド定義:**

| フィールド名 | 型 | 必須 | 説明 | 例 |
|--------------|------|------|------|-----|
| id | number | ○ | 問題の一意識別子 | 1 |
| question | string | ○ | 質問文 | "JavaScriptで..." |
| options | array[string] | ○ | 選択肢(4個固定) | ["let", "def", "var", "int"] |
| correctAnswer | number | ○ | 正解の選択肢インデックス(0〜3) | 0 |

**バリデーションルール:**
- `id`: 1以上の整数、重複なし
- `question`: 1文字以上の文字列
- `options`: 正確に4要素の配列、各要素は文字列
- `correctAnswer`: 0〜3の整数

### 6.2 実行時データ(JavaScript)

**変数名:** `currentQuiz`  
**説明:** 現在表示中の問題データ

**変数名:** `score`  
**説明:** 正解数カウンタ

**変数名:** `currentQuestionIndex`  
**説明:** 現在の問題番号(0始まり)

**変数名:** `shuffledQuizzes`  
**説明:** ランダムソート済みの問題配列

---

## 7. ユースケース

### 7.1 ユースケース図(テキスト表現)

```
ユーザー
  |
  |-- (クイズを開始する)
  |-- (問題を読む)
  |-- (選択肢を選ぶ)
  |-- (回答を確定する)
  |-- (次の問題に進む) ※ 自動遷移の場合は不要
  |-- (結果を確認する)
  |-- (再挑戦する)
```

### 7.2 メインユースケース: クイズに挑戦する

| 項目 | 内容 |
|------|------|
| ユースケースID | UC001 |
| ユースケース名 | クイズに挑戦する |
| アクター | ユーザー |
| 事前条件 | `index.html`をブラウザで開いている |
| 基本フロー | 1. システムが`quizzes.json`を読み込む<br>2. システムが問題をランダムソート<br>3. システムが1問目を表示<br>4. ユーザーが4択から1つ選択<br>5. ユーザーが「回答する」ボタンをクリック<br>6. システムが正誤判定を実施<br>7. システムが次の問題を表示(または結果画面)<br>8. 全10問終了まで4〜7を繰り返す<br>9. システムが最終スコアを表示 |
| 代替フロー | 3a. JSONファイルが読み込めない場合<br>   3a1. エラーメッセージを表示<br>   3a2. ユースケース終了 |
| 事後条件 | ユーザーが自分のスコアを確認できる |

### 7.3 サブユースケース: 再挑戦する

| 項目 | 内容 |
|------|------|
| ユースケースID | UC002 |
| ユースケース名 | 再挑戦する |
| アクター | ユーザー |
| 事前条件 | 結果画面が表示されている |
| 基本フロー | 1. ユーザーが「再挑戦」ボタンをクリック<br>2. システムがスコアをリセット<br>3. システムが問題を再シャッフル<br>4. UC001の基本フロー3に戻る |
| 事後条件 | 新たなクイズセッションが開始される |

---

## 8. 画面設計(ワイヤーフレーム)

### 8.1 問題画面

```
┌───────────────────────────────────────┐
│   JavaScriptクイズゲーム              │
├───────────────────────────────────────┤
│                                       │
│  問題 3/10                            │
│                                       │
│  JavaScriptで変数を宣言する           │
│  キーワードは次のうちどれ?            │
│                                       │
│  ┌─────────────────────────┐         │
│  │ ( ) A. let                │         │
│  └─────────────────────────┘         │
│  ┌─────────────────────────┐         │
│  │ ( ) B. def                │         │
│  └─────────────────────────┘         │
│  ┌─────────────────────────┐         │
│  │ ( ) C. var                │         │
│  └─────────────────────────┘         │
│  ┌─────────────────────────┐         │
│  │ ( ) D. int                │         │
│  └─────────────────────────┘         │
│                                       │
│        [ 回答する ]                   │
│                                       │
└───────────────────────────────────────┘
```

**要素:**
- タイトル
- 進捗表示(例: "問題 3/10")
- 質問文
- 選択肢4つ(ラジオボタンまたはクリック可能なボタン)
- 回答確定ボタン

### 8.2 結果画面

```
┌───────────────────────────────────────┐
│   JavaScriptクイズゲーム              │
├───────────────────────────────────────┤
│                                       │
│        お疲れ様でした!                │
│                                       │
│      あなたのスコア:                  │
│                                       │
│         10問中 8問正解                │
│                                       │
│        正解率: 80%                    │
│                                       │
│       [ 再挑戦する ]                  │
│                                       │
└───────────────────────────────────────┘
```

**要素:**
- 完了メッセージ
- 正解数表示
- 正解率表示(任意)
- 再挑戦ボタン

---

## 9. 技術要件

### 9.1 使用技術

| 分類 | 技術 | バージョン | 用途 |
|------|------|------------|------|
| フロントエンド | HTML5 | - | 画面構造 |
| スタイル | CSS3 | - | デザイン |
| プログラミング言語 | JavaScript | ES6以降 | ロジック実装 |
| データ形式 | JSON | - | 問題データ保存 |
| 実行環境 | Webブラウザ | Chrome/Edge/Firefox最新版 | アプリ実行 |

### 9.2 外部ライブラリ
- **使用しない**(Vanilla JavaScriptで実装)
- 理由: 学習目的のため、標準機能のみで実装

### 9.3 開発ツール
- エディタ: VS Code
- ブラウザ開発者ツール: デバッグ用
- バージョン管理: Git(任意)

---

## 10. ファイル構成

```
quiz-game/
│
├── index.html          # メインHTML(ゲーム画面)
├── style.css           # スタイルシート
├── app.js              # ゲームロジック
├── data/
│   └── quizzes.json    # 問題データ
└── README.md           # 使い方・説明書
```

### 10.1 各ファイルの役割

**index.html**
- ゲームのUI構造を定義
- 問題表示エリア、選択肢、ボタンなどのHTML要素

**style.css**
- レイアウトとデザイン
- シンプルで見やすいスタイル(中央寄せ、ボタンデザイン等)

**app.js**
- 問題読み込み処理
- ランダムソート
- 問題表示ロジック
- 回答判定
- スコア管理
- 画面遷移制御

**quizzes.json**
- 10問のクイズデータ
- 開発者がテキストエディタで直接編集

**README.md**
- 起動方法
- 遊び方
- 問題の追加方法

---

## 11. 運用要件

### 11.1 インストール手順
1. 全ファイルを任意のフォルダに配置
2. `index.html`をブラウザで開く

### 11.2 起動方法
- `index.html`をダブルクリック、またはブラウザにドラッグ&ドロップ

### 11.3 問題の追加・編集方法
1. `data/quizzes.json`をテキストエディタで開く
2. 問題配列に新しい問題オブジェクトを追加
3. 既定のフォーマットに従う(id, question, options, correctAnswer)
4. ファイルを保存
5. ブラウザをリロード

**追加例:**
```json
{
  "id": 11,
  "question": "新しい質問文?",
  "options": ["選択肢1", "選択肢2", "選択肢3", "選択肢4"],
  "correctAnswer": 2
}
```

### 11.4 バックアップ方針
- `quizzes.json`を定期的に別フォルダにコピー(手動)
- Git管理する場合はコミット履歴で管理

### 11.5 トラブルシューティング

| 問題 | 原因 | 対処法 |
|------|------|--------|
| 問題が表示されない | JSONファイルのパスが間違っている | `data/quizzes.json`の配置を確認 |
| エラーメッセージが出る | JSON形式が不正 | JSONフォーマットチェッカーで検証 |
| 選択肢が4つ表示されない | optionsの配列が4要素でない | 各問題のoptionsを4個に修正 |
| 正解が反映されない | correctAnswerの値が0〜3の範囲外 | 0〜3の値に修正 |

---

## 12. テスト要件

### 12.1 テスト観点

| テストID | テスト項目 | 確認内容 | 期待結果 |
|----------|-----------|----------|----------|
| T001 | 問題読み込み | `quizzes.json`が正常に読み込まれる | 10問のデータが取得できる |
| T002 | ランダム出題 | 問題の順序が毎回異なる | リロードするたびに順序が変わる |
| T003 | 問題表示 | 質問文と4つの選択肢が表示される | 画面に正しく表示される |
| T004 | 正解判定(正解) | 正解の選択肢を選ぶ | スコアが+1される |
| T005 | 正解判定(不正解) | 不正解の選択肢を選ぶ | スコアが増えない |
| T006 | 次問題遷移 | 回答後、次の問題に進む | 2問目以降が表示される |
| T007 | 全問終了 | 10問すべてに回答 | 結果画面が表示される |
| T008 | スコア表示 | 正解数が正しく表示される | "10問中X問正解"が正しい |
| T009 | 再挑戦 | 結果画面で再挑戦ボタンをクリック | 1問目に戻る |
| T010 | JSONエラー処理 | 不正なJSONファイル | エラーメッセージが表示される |

### 12.2 テスト方法
- 手動テスト(開発者による動作確認)
- ブラウザの開発者ツールでコンソールエラーを確認

---

## 13. リスク管理

### 13.1 技術リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| ブラウザ互換性の問題 | 中 | 低 | ES6で広くサポートされている機能のみ使用 |
| JSONファイルの読み込み失敗 | 高 | 低 | エラーハンドリングを実装 |
| 問題データの形式ミス | 中 | 中 | バリデーション関数を実装 |

### 13.2 運用リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 問題数が10問未満 | 高 | 低 | 最低10問を初期登録、不足時の警告表示 |
| JSONファイルの誤編集 | 中 | 中 | バックアップの習慣化、編集ガイドをREADMEに記載 |

---

## 14. 制約事項

### 14.1 技術的制約
- サーバーサイド処理なし(ブラウザのみで完結)
- データ永続化なし(リロードでスコアリセット)
- ファイルシステムへの書き込み不可(ブラウザ制限)
- 問題は`quizzes.json`のみ(複数ファイル非対応)

### 14.2 機能的制約
- 1セッションで10問固定
- 選択肢は4択のみ
- カテゴリ・難易度による絞り込みなし
- スコア履歴の保存なし
- タイマー機能なし

### 14.3 運用上の制約
- ローカル環境での実行のみ
- インターネット接続不要
- 問題の追加はJSON直接編集
- 複数人での同時プレイ不可

---

## 15. 将来の拡張案(任意)

### 15.1 機能拡張候補
- カテゴリ選択機能
- 難易度フィルター
- ヒント表示
- 間違えた問題の復習モード
- タイマー機能
- LocalStorageを使った簡易スコア保存
- 問題追加UI(管理画面)

### 15.2 技術的拡張候補
- フレームワーク導入(React, Vue.js)
- バックエンド追加(Node.js + Express)
- データベース移行(MongoDB, SQLite)
- 問題のCSVインポート機能
- モバイル対応(レスポンシブデザイン)

---

## 16. 承認・合意事項

### 16.1 確定事項
- [x] 実行環境: ブラウザ(HTML+JavaScript)
- [x] データ形式: JSON(単一ファイル)
- [x] 問題数: 10問
- [x] 選択肢: 4択固定
- [x] カテゴリ: なし
- [x] 難易度レベル: なし
- [x] スコア保存: なし
- [x] タイマー: なし
- [x] 問題追加方法: JSON直接編集

### 16.2 未決定事項(推奨案を適用)

| 項目 | 推奨案 | 理由 |
|------|--------|------|
| デザインの詳細度 | シンプルなCSS | 難しすぎない、短時間で実装可能 |
| 正誤判定のフィードバック | 簡易的な色変更 | ユーザビリティ向上、実装容易 |
| 正解率の表示 | 表示する | スコア表示に1行追加するだけ |
| エラーメッセージ | コンソールログ+画面表示 | デバッグしやすく、ユーザーにも通知 |

---

## 17. スケジュール(参考)

| フェーズ | 作業内容 | 想定時間 |
|----------|----------|----------|
| 要件定義 | 本文書作成 | 完了 |
| データ準備 | quizzes.json作成(10問) | 30分 |
| HTML作成 | index.htmlの骨組み | 30分 |
| CSS作成 | style.css基本スタイル | 30分 |
| JS実装 | app.js ロジック実装 | 1〜2時間 |
| テスト | 動作確認・バグ修正 | 30分 |
| ドキュメント | README.md作成 | 20分 |
| **合計** | | **3〜4時間** |

---

## 18. 付録

### 18.1 サンプル問題データ(10問分)

```json
{
  "quizzes": [
    {
      "id": 1,
      "question": "JavaScriptで変数を宣言するキーワードは次のうちどれ?",
      "options": ["let", "def", "var", "int"],
      "correctAnswer": 0
    },
    {
      "id": 2,
      "question": "HTMLの正式名称は?",
      "options": [
        "Hyper Text Markup Language",
        "High Tech Modern Language",
        "Home Tool Markup Language",
        "Hyperlinks and Text Markup Language"
      ],
      "correctAnswer": 0
    },
    {
      "id": 3,
      "question": "CSSで文字の色を変えるプロパティは?",
      "options": ["font-color", "text-color", "color", "background-color"],
      "correctAnswer": 2
    },
    {
      "id": 4,
      "question": "次のうち、プログラミング言語でないものは?",
      "options": ["Python", "Java", "HTML", "C++"],
      "correctAnswer": 2
    },
    {
      "id": 5,
      "question": "JSONの正式名称は?",
      "options": [
        "JavaScript Object Notation",
        "Java Standard Object Notation",
        "JavaScript Oriented Network",
        "Java Source Object Node"
      ],
      "correctAnswer": 0
    },
    {
      "id": 6,
      "question": "配列の最後に要素を追加するメソッドは?",
      "options": ["add()", "push()", "append()", "insert()"],
      "correctAnswer": 1
    },
    {
      "id": 7,
      "question": "次のうち、ループ処理に使われないものは?",
      "options": ["for", "while", "if", "forEach"],
      "correctAnswer": 2
    },
    {
      "id": 8,
      "question": "真偽値を表すデータ型は?",
      "options": ["boolean", "binary", "bit", "bool"],
      "correctAnswer": 0
    },
    {
      "id": 9,
      "question": "JavaScriptでコメントを書く記号は?(単一行)",
      "options": ["#", "//", "/*", "<!--"],
      "correctAnswer": 1
    },
    {
      "id": 10,
      "question": "オブジェクトのプロパティにアクセスする記号は?",
      "options": [":", ".", "->", "::"],
      "correctAnswer": 1
    }
  ]
}
```

### 18.2 参考リンク
- MDN Web Docs (JavaScript): https://developer.mozilla.org/ja/docs/Web/JavaScript
- JSON公式サイト: https://www.json.org/json-ja.html
- HTML5入門: https://developer.mozilla.org/ja/docs/Web/HTML

---

## 19. 変更履歴

| バージョン | 日付 | 変更者 | 変更内容 |
|------------|------|--------|----------|
| 1.0 | 2025-11-11 | rintarou | 初版作成 |

---

## 20. 承認欄

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| 作成者 | rintarou | 2025-11-11 | (確認済み) |

---

**本要件定義書に基づき、実装フェーズに進むことができます。**
